<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âœ¨ Realm of Memories âœ¨</title>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: #000;
            overflow: hidden;
            font-family: 'Cinzel', serif;
        }

        /* Deep Space Background */
        .space-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at center, #0a0015 0%, #000 100%);
        }

        /* Stars */
        .star {
            position: fixed;
            background: white;
            border-radius: 50%;
            animation: starTwinkle var(--duration) ease-in-out infinite;
            animation-delay: var(--delay);
        }

        @keyframes starTwinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.3); }
        }

        /* Yellow Flash Overlay */
        .realm-flash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, #ffd700, #ffaa00, #ff8800);
            opacity: 0;
            z-index: 1000;
            pointer-events: none;
        }

        .realm-flash.active {
            animation: realmFlash 2s ease-out forwards;
        }

        @keyframes realmFlash {
            0% { opacity: 0; transform: scale(0); }
            15% { opacity: 1; transform: scale(1.5); }
            30% { opacity: 0.9; }
            100% { opacity: 0; transform: scale(3); }
        }

        /* Time-Space Bending Effect */
        .timespace-warp {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 0;
            height: 0;
            border-radius: 50%;
            z-index: 500;
            pointer-events: none;
        }

        .timespace-warp.active {
            animation: spaceBend 3s ease-out forwards;
        }

        @keyframes spaceBend {
            0% {
                width: 0;
                height: 0;
                box-shadow: 
                    0 0 0 0 rgba(255, 215, 0, 0.8),
                    0 0 0 0 rgba(255, 170, 0, 0.6),
                    0 0 0 0 rgba(255, 136, 0, 0.4);
            }
            50% {
                width: 300px;
                height: 300px;
                box-shadow: 
                    0 0 100px 50px rgba(255, 215, 0, 0.8),
                    0 0 200px 100px rgba(255, 170, 0, 0.5),
                    0 0 300px 150px rgba(255, 136, 0, 0.3);
            }
            100% {
                width: 3000px;
                height: 3000px;
                box-shadow: 
                    0 0 0 0 rgba(255, 215, 0, 0),
                    0 0 0 0 rgba(255, 170, 0, 0),
                    0 0 0 0 rgba(255, 136, 0, 0);
            }
        }

        /* Distortion Rings */
        .distortion-ring {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 50%;
            border: 3px solid rgba(255, 215, 0, 0.8);
            opacity: 0;
            z-index: 501;
            pointer-events: none;
        }

        .distortion-ring.active {
            animation: ringExpand 2s ease-out forwards;
        }

        @keyframes ringExpand {
            0% {
                width: 0;
                height: 0;
                opacity: 1;
                border-width: 5px;
            }
            100% {
                width: 2000px;
                height: 2000px;
                opacity: 0;
                border-width: 1px;
            }
        }

        /* Golden Particles */
        .golden-particle {
            position: fixed;
            width: 6px;
            height: 6px;
            background: #ffd700;
            border-radius: 50%;
            pointer-events: none;
            z-index: 502;
            box-shadow: 0 0 10px #ffd700, 0 0 20px #ffaa00;
        }

        /* Title */
        .title-container {
            position: fixed;
            top: 5%;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            z-index: 100;
            opacity: 0;
        }

        .title-container.show {
            animation: titleFadeIn 1.5s ease-out forwards;
        }

        @keyframes titleFadeIn {
            from { opacity: 0; transform: translateX(-50%) translateY(-30px); }
            to { opacity: 1; transform: translateX(-50%) translateY(0); }
        }

        .main-title {
            font-family: 'Great Vibes', cursive;
            font-size: clamp(2.5rem, 8vw, 4.5rem);
            background: linear-gradient(135deg, #ffd700, #ff6b9d, #a855f7, #00bfff, #ffd700);
            background-size: 400% 400%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: shimmer 5s ease infinite;
            filter: drop-shadow(0 0 30px rgba(255, 215, 0, 0.6));
            text-shadow: 0 0 80px rgba(255, 215, 0, 0.5);
            letter-spacing: 2px;
        }

        .title-container .sub-title {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.7);
            letter-spacing: 5px;
            margin-top: 10px;
            animation: subtitleFade 2s ease forwards 0.5s;
            opacity: 0;
        }

        @keyframes subtitleFade {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes shimmer {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* Photo Gallery Container */
        .gallery-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
        }

        .gallery-container.active {
            opacity: 1;
            pointer-events: auto;
        }

        /* Photo Cards */
        .photo-card {
            position: absolute;
            width: 280px;
            height: 350px;
            border-radius: 20px;
            overflow: hidden;
            opacity: 0;
            transform: scale(0) translate(-50%, -50%);
            left: 50%;
            top: 50%;
            box-shadow: 
                0 0 30px rgba(255, 215, 0, 0.4),
                0 0 60px rgba(255, 107, 157, 0.2);
            transition: all 0.5s ease;
            cursor: pointer;
            will-change: transform, opacity;
            backface-visibility: hidden;
        }

        .photo-card::before {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            background: linear-gradient(45deg, #ffd700, #ff6b9d, #a855f7, #ffd700);
            background-size: 300% 300%;
            border-radius: 23px;
            z-index: -1;
            animation: borderGlow 6s ease infinite;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .photo-card.emerge::before {
            opacity: 1;
            animation: borderGlow 6s ease infinite, pulseGlow 2s ease-out;
        }
        
        @keyframes pulseGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.5); }
        }

        @keyframes borderGlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .photo-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-card.emerge {
            animation: photoEmergeFromCenter 2.5s cubic-bezier(0.25, 0.1, 0.25, 1) forwards;
        }

        .photo-card.move-left {
            animation: moveToLeft 1s ease-out forwards;
        }

        .photo-card.move-right {
            animation: moveToRight 1s ease-out forwards;
        }

        .photo-card.move-far-left {
            animation: moveToFarLeft 1s ease-out forwards;
        }

        .photo-card.move-far-right {
            animation: moveToFarRight 1s ease-out forwards;
        }

        .photo-card.move-top-left {
            animation: moveToTopLeft 1s ease-out forwards;
        }

        .photo-card.move-top-right {
            animation: moveToTopRight 1s ease-out forwards;
        }

        .photo-card.center {
            animation: stayCenter 0.8s ease-out forwards;
        }

        @keyframes photoEmergeFromCenter {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.3);
                filter: blur(8px);
            }
            40% {
                opacity: 0.7;
                transform: translate(-50%, -50%) scale(0.85);
                filter: blur(2px);
            }
            70% {
                opacity: 0.95;
                transform: translate(-50%, -50%) scale(1.02);
                filter: blur(0);
            }
            100% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
                filter: blur(0);
            }
        }

        @keyframes moveToLeft {
            from { transform: translate(-50%, -50%) scale(1); }
            to { transform: translate(calc(-50% - 320px), -50%) scale(0.85) rotate(-5deg); }
        }

        @keyframes moveToRight {
            from { transform: translate(-50%, -50%) scale(1); }
            to { transform: translate(calc(-50% + 320px), -50%) scale(0.85) rotate(5deg); }
        }

        @keyframes moveToFarLeft {
            from { transform: translate(-50%, -50%) scale(1); }
            to { transform: translate(calc(-50% - 550px), -50%) scale(0.7) rotate(-10deg); opacity: 0.7; }
        }

        @keyframes moveToFarRight {
            from { transform: translate(-50%, -50%) scale(1); }
            to { transform: translate(calc(-50% + 550px), -50%) scale(0.7) rotate(10deg); opacity: 0.7; }
        }

        @keyframes moveToTopLeft {
            from { transform: translate(-50%, -50%) scale(1); }
            to { transform: translate(calc(-50% - 400px), calc(-50% - 200px)) scale(0.6) rotate(-15deg); opacity: 0.5; }
        }

        @keyframes moveToTopRight {
            from { transform: translate(-50%, -50%) scale(1); }
            to { transform: translate(calc(-50% + 400px), calc(-50% - 200px)) scale(0.6) rotate(15deg); opacity: 0.5; }
        }

        @keyframes stayCenter {
            from { transform: translate(-50%, -50%) scale(1); }
            to { transform: translate(-50%, -50%) scale(1.1); }
        }

        /* Positioned states */
        .photo-card.pos-left { 
            transform: translate(calc(-50% - 320px), -50%) scale(0.85) rotate(-5deg) !important; 
            opacity: 1 !important;
        }
        .photo-card.pos-right { 
            transform: translate(calc(-50% + 320px), -50%) scale(0.85) rotate(5deg) !important; 
            opacity: 1 !important;
        }
        .photo-card.pos-far-left { 
            transform: translate(calc(-50% - 550px), -50%) scale(0.7) rotate(-10deg) !important; 
            opacity: 0.7 !important;
        }
        .photo-card.pos-far-right { 
            transform: translate(calc(-50% + 550px), -50%) scale(0.7) rotate(10deg) !important; 
            opacity: 0.7 !important;
        }
        .photo-card.pos-top-left { 
            transform: translate(calc(-50% - 400px), calc(-50% - 200px)) scale(0.6) rotate(-15deg) !important; 
            opacity: 0.5 !important;
        }
        .photo-card.pos-top-right { 
            transform: translate(calc(-50% + 400px), calc(-50% - 200px)) scale(0.6) rotate(15deg) !important; 
            opacity: 0.5 !important;
        }
        .photo-card.pos-center { 
            transform: translate(-50%, -50%) scale(1.1) !important; 
            opacity: 1 !important;
            z-index: 200 !important;
        }

        .photo-card:hover {
            z-index: 300 !important;
            transform: translate(-50%, -50%) scale(1.2) rotate(0deg) !important;
            opacity: 1 !important;
            box-shadow: 
                0 0 50px rgba(255, 215, 0, 0.6),
                0 0 100px rgba(255, 107, 157, 0.4);
        }

        /* Continue Button */
        .continue-btn {
            position: fixed;
            bottom: 8%;
            left: 50%;
            transform: translateX(-50%);
            padding: 18px 55px;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.25), rgba(255, 107, 157, 0.25), rgba(168, 85, 247, 0.25));
            background-size: 200% 200%;
            border: 2px solid rgba(255, 215, 0, 0.6);
            border-radius: 50px;
            color: white;
            font-family: 'Cinzel', serif;
            font-size: 1.15rem;
            letter-spacing: 4px;
            cursor: pointer;
            z-index: 1000;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            backdrop-filter: blur(15px);
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
            animation: btnGradient 3s ease infinite;
        }

        @keyframes btnGradient {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .continue-btn.show {
            opacity: 1;
            animation: btnPulse 2s ease-in-out infinite, btnGradient 3s ease infinite;
        }

        .continue-btn:hover {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.45), rgba(255, 107, 157, 0.45), rgba(168, 85, 247, 0.45));
            transform: translateX(-50%) scale(1.08) translateY(-3px);
            box-shadow: 
                0 0 40px rgba(255, 215, 0, 0.6),
                0 0 80px rgba(255, 107, 157, 0.4),
                0 20px 40px rgba(0, 0, 0, 0.3);
            border-color: rgba(255, 215, 0, 0.9);
        }

        @keyframes btnPulse {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.3); }
            50% { box-shadow: 0 0 40px rgba(255, 215, 0, 0.6); }
        }

        /* Floating Sparkles */
        .sparkle {
            position: fixed;
            pointer-events: none;
            z-index: 600;
            font-size: 1.5rem;
            animation: sparkleFloat 3s ease-out forwards;
        }

        @keyframes sparkleFloat {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            100% { opacity: 0; transform: translateY(-100px) scale(0); }
        }

        /* Music Control */
        .music-control {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 10000;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255, 215, 0, 0.3);
            border: 2px solid rgba(255, 215, 0, 0.6);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        .music-control:hover { background: rgba(255, 215, 0, 0.5); transform: scale(1.1); }
        .music-control.playing { animation: musicPulse 1s ease-in-out infinite; }
        @keyframes musicPulse {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.5); }
            50% { box-shadow: 0 0 40px rgba(255, 215, 0, 0.8); }
        }

        /* Realm Portal in Center */
        .realm-portal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 215, 0, 0.8) 0%, rgba(255, 170, 0, 0.5) 40%, transparent 70%);
            z-index: 400;
            opacity: 0;
            animation: portalPulse 2s ease-in-out infinite;
        }

        .realm-portal.active {
            animation: portalOpen 1.5s ease-out forwards;
        }

        @keyframes portalPulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); box-shadow: 0 0 50px rgba(255, 215, 0, 0.5); }
            50% { transform: translate(-50%, -50%) scale(1.1); box-shadow: 0 0 100px rgba(255, 215, 0, 0.8); }
        }

        @keyframes portalOpen {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0); }
            30% { opacity: 1; transform: translate(-50%, -50%) scale(1.5); }
            60% { opacity: 1; transform: translate(-50%, -50%) scale(2); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(5); }
        }

        /* Loading text */
        .loading-text {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: rgba(255, 215, 0, 0.8);
            font-size: 1.5rem;
            letter-spacing: 5px;
            z-index: 300;
            opacity: 0;
        }

        .loading-text.show {
            animation: loadingPulse 1s ease-in-out infinite;
        }

        @keyframes loadingPulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- Background Music -->
    <audio id="bgMusic" loop preload="auto">
        <source src="Bts_Euphoria_Song_Jungkook_Korean_Song_Ringtone_(by Fringster.com).mp3" type="audio/mpeg">
    </audio>
    <button class="music-control" id="musicBtn" title="Toggle Music">ðŸŽµ</button>

    <div class="space-bg"></div>
    
    <!-- Realm Opening Effects -->
    <div class="realm-flash" id="realmFlash"></div>
    <div class="timespace-warp" id="timespaceWarp"></div>
    <div class="distortion-ring" id="ring1"></div>
    <div class="distortion-ring" id="ring2"></div>
    <div class="distortion-ring" id="ring3"></div>
    <div class="realm-portal" id="realmPortal"></div>

    <div class="loading-text" id="loadingText">Opening the Realm...</div>

    <div class="title-container" id="titleContainer">
        <h1 class="main-title">Precious Memories</h1>
        <p class="sub-title">âœ§ A Journey Through Time âœ§</p>
    </div>

    <div class="gallery-container" id="galleryContainer"></div>

    <button class="continue-btn" id="continueBtn">âœ¨ Continue âœ¨</button>

    <script>
        // Create stars (optimized for performance)
        for (let i = 0; i < 20; i++) {
            const star = document.createElement('div');
            star.className = 'star';
            star.style.left = Math.random() * 100 + '%';
            star.style.top = Math.random() * 100 + '%';
            star.style.width = star.style.height = (Math.random() * 2 + 1) + 'px';
            star.style.setProperty('--duration', (3 + Math.random() * 4) + 's');
            star.style.setProperty('--delay', Math.random() * 5 + 's');
            document.body.appendChild(star);
        }

        // Photos configuration
        const photos = [
            'photos/photo1.jpeg',
            'photos/photo2.jpeg',
            'photos/photo3.png',
            'photos/photo4.jpeg',
            'photos/photo5.jpeg',
            'photos/photo6.jpeg',
            'photos/photo7.jpeg'
        ];

        // Position assignments for photos spreading out
        const positions = [
            'pos-center',
            'pos-left',
            'pos-right',
            'pos-far-left',
            'pos-far-right',
            'pos-top-left',
            'pos-top-right'
        ];

        let photoCards = [];

        // Create golden particles explosion (optimized for performance)
        function createGoldenParticles() {
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            
            for (let i = 0; i < 12; i++) {
                const particle = document.createElement('div');
                particle.className = 'golden-particle';
                particle.style.left = centerX + 'px';
                particle.style.top = centerY + 'px';
                document.body.appendChild(particle);

                const angle = (Math.PI * 2 * i) / 50;
                const distance = 200 + Math.random() * 400;
                const duration = 1 + Math.random() * 1.5;

                particle.animate([
                    { 
                        transform: 'translate(-50%, -50%) scale(1)',
                        opacity: 1
                    },
                    { 
                        transform: `translate(calc(-50% + ${Math.cos(angle) * distance}px), calc(-50% + ${Math.sin(angle) * distance}px)) scale(0)`,
                        opacity: 0
                    }
                ], {
                    duration: duration * 1000,
                    easing: 'ease-out'
                });

                setTimeout(() => particle.remove(), duration * 1000);
            }
        }

        // Create floating sparkles
        function createSparkle(x, y) {
            const sparkles = ['âœ¨', 'â­', 'ðŸ’«', 'âœ§', 'â˜…'];
            const sparkle = document.createElement('div');
            sparkle.className = 'sparkle';
            sparkle.textContent = sparkles[Math.floor(Math.random() * sparkles.length)];
            sparkle.style.left = x + 'px';
            sparkle.style.top = y + 'px';
            sparkle.style.color = ['#ffd700', '#ff6b9d', '#a855f7'][Math.floor(Math.random() * 3)];
            document.body.appendChild(sparkle);
            setTimeout(() => sparkle.remove(), 3000);
        }

        // Create photo cards
        function createPhotoCards() {
            const container = document.getElementById('galleryContainer');
            
            photos.forEach((photoSrc, index) => {
                const card = document.createElement('div');
                card.className = 'photo-card';
                card.style.zIndex = 100 + index;
                
                const img = document.createElement('img');
                img.src = photoSrc;
                img.alt = `Memory ${index + 1}`;
                card.appendChild(img);
                
                container.appendChild(card);
                photoCards.push(card);
            });
        }

        // Open the realm with dramatic effect
        function openRealm() {
            const loadingText = document.getElementById('loadingText');
            loadingText.classList.add('show');

            // Start portal opening
            setTimeout(() => {
                document.getElementById('realmPortal').classList.add('active');
            }, 500);

            // Yellow flash
            setTimeout(() => {
                document.getElementById('realmFlash').classList.add('active');
                createGoldenParticles();
            }, 1000);

            // Time-space warp
            setTimeout(() => {
                document.getElementById('timespaceWarp').classList.add('active');
            }, 1200);

            // Distortion rings
            setTimeout(() => {
                document.getElementById('ring1').classList.add('active');
            }, 1400);
            setTimeout(() => {
                document.getElementById('ring2').classList.add('active');
            }, 1600);
            setTimeout(() => {
                document.getElementById('ring3').classList.add('active');
            }, 1800);

            // Hide loading text and show title
            setTimeout(() => {
                loadingText.classList.remove('show');
                document.getElementById('titleContainer').classList.add('show');
            }, 2500);

            // Start photo emergence
            setTimeout(() => {
                emergePhotos();
            }, 3000);
        }

        // Emerge photos one by one, then disappear one by one in a cycle
        let currentPhotoIndex = 0;
        let isDisplayCycleActive = false;

        function emergePhotos() {
            const container = document.getElementById('galleryContainer');
            container.classList.add('active');
            isDisplayCycleActive = true;
            
            // Show continue button after initial display
            setTimeout(() => {
                document.getElementById('continueBtn').classList.add('show');
            }, 6000);
            
            // Start the cyclic display
            showNextPhoto();
        }

        function showNextPhoto() {
            if (!isDisplayCycleActive || currentPhotoIndex >= photoCards.length) {
                // All photos shown, start disappearing them
                setTimeout(() => hidePhotos(), 1200);
                return;
            }

            const card = photoCards[currentPhotoIndex];
            card.classList.add('emerge');
            card.style.opacity = '1';
            
            // Create mini particle burst on photo appearance
            createMiniParticleBurst();
            
            // Create sparkles around emerged photo (reduced for performance)
            for (let i = 0; i < 2; i++) {
                setTimeout(() => {
                    createSparkle(
                        window.innerWidth / 2 + (Math.random() - 0.5) * 150,
                        window.innerHeight / 2 + (Math.random() - 0.5) * 150
                    );
                }, i * 200);
            }

            currentPhotoIndex++;
            
            // Show next photo after delay (slower for gentler experience)
            setTimeout(() => showNextPhoto(), 2500);
        }
        
        // Mini particle burst for photo appearance (optimized for performance)
        function createMiniParticleBurst() {
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            
            for (let i = 0; i < 6; i++) {
                const particle = document.createElement('div');
                particle.className = 'golden-particle';
                particle.style.left = centerX + 'px';
                particle.style.top = centerY + 'px';
                particle.style.width = '4px';
                particle.style.height = '4px';
                document.body.appendChild(particle);

                const angle = (Math.PI * 2 * i) / 12;
                const distance = 80 + Math.random() * 100;
                const duration = 0.6 + Math.random() * 0.4;

                particle.animate([
                    { 
                        transform: 'translate(-50%, -50%) scale(1)',
                        opacity: 1
                    },
                    { 
                        transform: `translate(calc(-50% + ${Math.cos(angle) * distance}px), calc(-50% + ${Math.sin(angle) * distance}px)) scale(0)`,
                        opacity: 0
                    }
                ], {
                    duration: duration * 1000,
                    easing: 'ease-out'
                });

                setTimeout(() => particle.remove(), duration * 1000);
            }
        }

        function hidePhotos() {
            let hideIndex = 0;
            
            function hideNextPhoto() {
                if (hideIndex >= photoCards.length) {
                    // All hidden, restart the cycle
                    setTimeout(() => {
                        currentPhotoIndex = 0;
                        emergePhotos();
                    }, 1500);
                    return;
                }

                const card = photoCards[hideIndex];
                card.style.transition = 'opacity 1.2s ease, transform 1.2s ease';
                card.style.opacity = '0';
                card.style.transform = 'translate(-50%, -50%) scale(0.8)';
                
                setTimeout(() => {
                    card.classList.remove('emerge');
                    card.style.transform = '';
                }, 1200);

                hideIndex++;
                setTimeout(() => hideNextPhoto(), 1400);
            }
            
            hideNextPhoto();
        }

        // Initialize
        createPhotoCards();

        // Start the realm opening after a short delay
        setTimeout(() => {
            openRealm();
        }, 1000);

        // Continue button
        document.getElementById('continueBtn').addEventListener('click', () => {
            document.body.style.transition = 'opacity 1.5s ease';
            document.body.style.opacity = '0';
            setTimeout(() => {
                window.location.href = 'letter-reveal.html';
            }, 1500);
        });

        // Sparkle effect on mouse move (throttled for performance)
        let lastSparkleTime = 0;
        document.addEventListener('mousemove', (e) => {
            const now = Date.now();
            if (now - lastSparkleTime > 300) {
                if (Math.random() > 0.85) {
                    createSparkle(e.clientX, e.clientY);
                }
                lastSparkleTime = now;
            }
        });

        // Music Control
        const bgMusic = document.getElementById('bgMusic');
        const musicBtn = document.getElementById('musicBtn');
        let musicPlaying = false;
        let musicInitialized = false;

        function initMusic() {
            if (musicInitialized) return;
            musicInitialized = true;
            
            const savedTime = localStorage.getItem('musicTime');
            if (savedTime) bgMusic.currentTime = parseFloat(savedTime);
            bgMusic.volume = 0.7;
            
            bgMusic.play().then(() => {
                musicPlaying = true;
                musicBtn.textContent = 'ðŸ”Š';
                musicBtn.classList.add('playing');
                localStorage.setItem('musicPlaying', 'true');
            }).catch(err => {
                console.log('Autoplay blocked, waiting for interaction');
                musicBtn.style.animation = 'musicPulse 0.5s ease-in-out infinite';
            });
        }

        function toggleMusic() {
            if (musicPlaying) {
                bgMusic.pause();
                musicPlaying = false;
                musicBtn.textContent = 'ðŸ”‡';
                musicBtn.classList.remove('playing');
                localStorage.setItem('musicPlaying', 'false');
            } else {
                bgMusic.play().then(() => {
                    musicPlaying = true;
                    musicBtn.textContent = 'ðŸ”Š';
                    musicBtn.classList.add('playing');
                    localStorage.setItem('musicPlaying', 'true');
                }).catch(() => {});
            }
        }

        function tryStartMusic() {
            if (!musicPlaying && !musicInitialized) {
                initMusic();
            }
        }

        window.addEventListener('beforeunload', () => {
            if (musicPlaying) localStorage.setItem('musicTime', bgMusic.currentTime);
        });

        musicBtn.addEventListener('click', toggleMusic);
        document.addEventListener('click', tryStartMusic, { once: true });
        document.addEventListener('touchstart', tryStartMusic, { once: true });
        document.addEventListener('keydown', tryStartMusic, { once: true });
        
        window.addEventListener('load', () => {
            setTimeout(initMusic, 100);
        });
    </script>
</body>
</html>
